

var Snoop = function(permissions){
	var _permissions = permissions;
	
	this.check = function(ip){
		if (permissions.isBanned(ip)) {
		router.drop(response);
		msg = "IP " + ip + " is banned";
		sys.log(msg);
		return;
		}
		// check the requests against whitelist
		if (!permissions.isAllowed(ip)) {
			msg = "IP " + ip + " is not allowed to use this proxy";
			router.reject(response, msg);
			sys.log(msg);
			return;
		}
	};

};