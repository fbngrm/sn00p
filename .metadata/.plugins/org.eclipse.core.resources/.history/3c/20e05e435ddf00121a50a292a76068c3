var sys  = require('sys');

BruteForce = function() {
	var _this = this;
	var _time = 30;
	var _maxTries = 5;
	var _connections = {};

	var addConnection = function(ip){
		sys.log('Adding ' + ip + ' to connections');
		_connections[ip] +=1; 
		sys.log(_connections[ip]);
	};
	
	this.check = function(ip){
		sys.log('BruteForce check ...');
		if (_connections[ip] != undefined) {
			sys.log('Brute-Force detected - Culprit: ' + ip);
			return true;
		} else {
			addConnection(ip);
			return false;
		}
	};
};
exports.BruteForce = BruteForce;