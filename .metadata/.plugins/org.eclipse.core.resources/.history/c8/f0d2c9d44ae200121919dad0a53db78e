var patterns = require('../conf/patterns').patterns;
var sys = require('sys');


var SQLi = function() {

	var _threshold = 1;
	var _suspects = 0;

	this.check = function(request, response, buffer){
		
		for (var i = patterns.sql.length -1; i >= 0; --i) {
			sys.log('sqli check for ip: ' + request.connection.remoteAddress);
			sys.log('checking data ...');
			if (patterns.sql[i].test(buffer)) _suspects++;
		}
		if (_suspects >= _threshold) return true;
		else return false;
	};
};

exports.SQLi = SQLi;